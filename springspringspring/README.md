# SpringSpringSpring

# Assignment

There's this giant Spring fanboy who won't let me into his fanclub until I can give him the code. I hope I can get in before Studio 100 finds out about this massive abuse of their IP.

(attached is the jar in this folder, or generated by running `./gradlew bootJar` and copying it from `build/lib/`)

# Solution

After running the jar for a first time, you can notice that it does some form of checking for a pincode. If you use wireshark, you'll see that no traffic is being sent to the network. This means that the code is checked within the JAR.

When you decompile the app using Ghidra, you can check the code inside the JAR. You'll see two main components:
- A CodeChecker, which compares the code you've entered to a given SHA512 sum.
- A FlagRetriever, which will send a request to a web application to ask for the flag once we've entered the correct code.

You can go about this in two ways: you can figure out for which code the SHA512 sum matches. As it consists of 'only' 10 digits, you should be able to calculate all possible hashes on your laptop within e.g. 30 minutes. The other option is to brute-force this web endpoint. If you try to contact the web endpoint manually, you'll see that it is pretty slow. Going over 1 000 000 000 options will take a while.

When you extract the SHA512sum from the code, you can write a little Python script to loop over all possible values. Such a script is included in `solution.py`. Maybe a rainbow table already exists online, which can save you more lookup time. By running this script, you can figure out that the code is `048116203` (the trailing zero is something important to keep in mind when calculating a rainbow table).

If you were to go for the (slower and resource-intense) brute-force approach, you would find the flag immediately with a script like the provided solution bash script.

# Deployment

1. Deploy the PHP script in the server folder on a webserver that will be available throughout the event. I've deployed it as ctf.wardsegers.be/spring.php, but if this wouldn't be available, you can host it basically anywhere.
1. Change the value in FlagRetriever to match with your URL (and in the `bruteforce.sh` file).
1. If you want to change the valid pincode, change it in the PHP file and adjust the hash in both the Java project and the solution.
1. Package JAR by using `./gradlew bootJar`. The JAR can be found in build/lib
